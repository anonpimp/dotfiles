#!/bin/bash

# requieres gpick xclip imagemagick

TEMP_DIR=/tmp/xcolor

[ ! -d $TEMP_DIR ] && mkdir -p $TEMP_DIR

abort() {
  dunstify -a "Color Picker info" -i dialog-error "Color Picker" "aborted"
  exit 1
}

pick() {
  
  HEX_COLOR=$(gpick -pso --no-newline)

  [[ -z $HEX_COLOR ]] && abort

  HEX="${HEX_COLOR#\#}"
  FNAME="$TEMP_DIR/$HEX.png"

  convert -size 100x100 xc:"$HEX_COLOR" "$FNAME"

  COLOR_CODE="$HEX_COLOR"

  echo "$COLOR_CODE" | tr -d '\n' | xclip -sel c

  dunstify -u low -a "Color Picker" -i "$FNAME" $COLOR_CODE "Copied to clipboard"
}

pick
