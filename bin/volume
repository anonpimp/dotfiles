#!/bin/bash

# requieres pamixer

DIR="$HOME/.config/dunst/icons"

send_notification() {
  volume=$(pamixer --get-volume)
  if [ "$volume" = "0" ]; then
    icon_name="$DIR/volume-muted.svg"
  else
    if [ "$volume" -lt "30" ]; then
      icon_name="$DIR/volume-low.svg"
    else
      if [ "$volume" -lt "80" ]; then
        icon_name="$DIR/volume-medium.svg"
      else
        icon_name="$DIR/volume-high.svg"
      fi
    fi
  fi
  # Send the notification
  dunstify "$volume%" -a "Volume" -i $icon_name -r 666 -u low -h int:value:$(($volume))
}

case $1 in
--up)
  # Unmute
  pamixer -u >/dev/null
  # +2%
  pamixer -i 2 >/dev/null
  send_notification
  ;;
--down)
  # Unmute
  pamixer -u >/dev/null
  # -2%
  pamixer -d 2 >/dev/null
  send_notification
  ;;
--toggle)
  # Toggle mute
  pamixer -t >/dev/null
  if [[ $(pamixer --get-mute) == 'true' ]]; then
    icon_name="$DIR/volume-muted.svg"
    dunstify -a "Volume" -i $icon_name "Muted" -r 666 -u low -h string:synchronous:audio-volume
  else
    send_notification
  fi
  ;;
esac
